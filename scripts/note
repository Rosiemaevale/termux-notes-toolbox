#!/usr/bin/env bash

NOTE_DIR="$HOME/notes"
FILE="$NOTE_DIR/notes.txt"
DATE=$(date +"%Y-%m-%d")
TIME=$(date +"%H:%M")

mkdir -p "$NOTE_DIR"

if [ ! -f "$NOTE_DIR/.last_date" ] || [ "$(cat "$NOTE_DIR/.last_date")" != "$DATE" ]; then
  echo -e "\n===== $DATE =====\n" >> "$FILE"
  echo "$DATE" > "$NOTE_DIR/.last_date"
fi

if [ $# -eq 0 ]; then
  echo "enter note. ctrl+d to save."
  echo "[$DATE $TIME]"
  cat >> "$FILE"
else
  echo "[$DATE $TIME] $*" >> "$FILE"
fi

echo "" >> "$FILE"
echo "saved."
